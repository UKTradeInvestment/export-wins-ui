var ew={components:{},pages:{},tools:{},application:{components:{}}};ew.CustomEvent=function(){function a(){this.subscribers=[]}var b=a.prototype;return b.subscribe=function(a){this.subscribers.push(a)},b.unSubscribe=function(a){for(var b=0,c=this.subscribers.length;b<c;b++)if(this.subscribers[b]===a){this.subscribers.pop(b,1);break}},b.publish=function(){for(var a=this.subscribers.length-1;a>=0;a--)try{this.subscribers[a].apply(this,arguments)}catch(a){}},a}(),ew.tools.toLocaleString=function(a,b,c){b=b||",",c=0===c?c:3;for(var d,e=(""+a).split("."),f=e[0].length,g="";f>c;)d=f-c,g=b+e[0].slice(d,f)+g,f=d;return g=e[0].slice(0,f)+g,e[0]=g,e.join(".")},ew.components.AddContributors=function(a){function b(a){return a+" is required for AddContributorsComponent"}function c(c){if(!c)throw new Error(b("opts"));if(!c.contributorsSelector)throw new Error(b("opts.contributorsSelector"));if(!c.nameInputSelector)throw new Error(b("opts.nameInputSelector"));var d=this;this.$contributors=a(c.contributorsSelector),this.contributorsSelector=c.contributorsSelector,this.nameInputSelector=c.nameInputSelector,this.shownContributors=0,this.contributorsLength=this.$contributors.length,this.$removeButton=a('<button type="button" class="btn btn-xs btn-default remove-contributor" aria-label="Remove contributor" title="Remove contributor">Remove</button>'),this.createAddButton(),this.hideContributingLines(),this.showCloseButton(),this.$addButton.on("click",a.proxy(this.addContributor,this)),this.$contributors.on("click",".remove-contributor",function(a){d.removeContributor(a,this)})}return c.prototype.focusOnFirstNameInput=function(){var b=a(this.$contributors[0]).find(this.nameInputSelector);b.val()||b.focus()},c.prototype.showCloseButton=function(){var b=a(this.contributorsSelector+":visible").last();b.is(this.$contributors[0])||b.prepend(this.$removeButton)},c.prototype.removeCloseButton=function(){this.$removeButton.remove()},c.prototype.updateCloseButton=function(){var a=this;this.removeCloseButton(),window.setTimeout(function(){a.showCloseButton()},1)},c.prototype.createAddButton=function(){this.$addButton=a('<button class="btn btn-default">Add another contributor</button>'),this.$contributors.parent().append(this.$addButton)},c.prototype.hideContributingLines=function(){var b=this;b.$contributors.each(function(c){var d,e=a(this);0===c?e.show():c>b.shownContributors?(d=e.find(b.nameInputSelector),d.val().length>0?(e.show(),b.shownContributors++):e.hide()):e.hide()})},c.prototype.addContributor=function(b){var c;b.preventDefault(),this.shownContributors<this.contributorsLength?(this.shownContributors++,c=a(this.$contributors[this.shownContributors]),c.show(),c.find(this.nameInputSelector).focus(),this.updateCloseButton(),this.checkAddButtonState()):alert("Sorry, the system can't add more than 5 contributing teams. Please choose teams that contributed the most.")},c.prototype.checkAddButtonState=function(){var a=this.shownContributors===this.contributorsLength-1;this.$addButton[0].disabled=a},c.prototype.removeContributor=function(b,c){var d=a(c).parent(this.contributorsSelector);d.hide(),d.find("input").val(""),d.find("select").each(function(){this.selectedIndex=0}),this.shownContributors--,this.updateCloseButton(),this.checkAddButtonState()},c}(jQuery),ew.components.AddSelect=function(a){function b(a){return a+" is required for AddSelectComponent"}function c(c){if(!c)throw new Error(b("opts"));if(!c.selector)throw new Error(b("opts.selector"));if(!c.labelText)throw new Error(b("opts.labelText"));this.selector=c.selector,this.required=!!c.required,this.labelText=c.labelText,this.buttonText=c.buttonText||"Add another",this.minVisible=0===c.minVisible?0:c.minVisible||1,this.$selects=a(this.selector),this.$groups=this.$selects.closest(".form-group"),this.$group=this.$selects.closest(".add-select-group"),this.count=this.$selects.length,this.visible=this.count,this.$addButton=a('<button class="btn btn-default">'+this.buttonText+"</button>"),this.$removeButton=a('<button class="btn btn-default remove-select">Remove</button>'),this.hideOthers(),this.createLabel(),this.$addButton.appendTo(this.$group),this.updateRemoveButton(),this.checkAddButtonState(),this.$addButton.on("click",a.proxy(this.addSelect,this)),this.$groups.on("click",".remove-select",a.proxy(this.removeSelect,this))}var d="disabled";return c.prototype.createLabel=function(){this.$groups.find("label, span").remove();var b=a('<h4 class="form-label">'+this.labelText+"</h4>");this.required&&b.prepend('<span class="required">*</span>'),this.$group.prepend(b)},c.prototype.removeSelect=function(b){b.preventDefault(),this.visible--,a(this.$groups[this.visible]).hide(),this.$selects[this.visible].selectedIndex=0,this.visible<this.count&&this.$addButton.removeClass(d),this.updateRemoveButton()},c.prototype.hideOthers=function(){for(var b=this.minVisible;b<this.count;b++)0===this.$selects[b].selectedIndex&&(a(this.$groups[b]).hide(),this.visible--)},c.prototype.checkAddButtonState=function(){this.visible===this.count&&this.$addButton.addClass(d)},c.prototype.updateRemoveButton=function(){this.visible>this.minVisible?this.$removeButton.insertAfter(this.$selects[this.visible-1]):this.$removeButton.remove()},c.prototype.addSelect=function(b){b.preventDefault(),this.visible<this.count&&(a(this.$groups[this.visible]).show(),this.visible++,this.updateRemoveButton(),this.checkAddButtonState())},c}(jQuery),ew.components.CalculateExportValue=function(a,b,c){function d(a){return a+" is required for CalculateExportValueComponent"}function e(a){if(!a)throw new Error(d("opts"));if(!a.values)throw new Error(d("opts.values"));if(!a.total)throw new Error(d("opts.total"));this.values=a.values,this.$total=b("#"+a.total),this.currency="Â£",this.$values=[],this.updateHtml(),this.getValueElems(),this.setupListeners(),this.updateValue()}var f=/^0+$/;return e.prototype.updateHtml=function(){var b="export-total-years",c="export-total-value",d=this.$total.parents(".form-group"),e=a.createElement("p");this.$total.hide(),d.find(".help-text").hide(),d.find("label").hide(),d.find(".required").hide(),e.className="export-total",e.innerHTML='Totaling over <span class="'+b+'"></span>: <span class="'+c+'"</span>',d[0].appendChild(e),this.$totalYears=d.find("."+b),this.$totalValue=d.find("."+c)},e.prototype.getValueElems=function(){for(var a,c=0;a=this.values[c++];)a="#"+a,this.$values.push(b(a))},e.prototype.setupListeners=function(){function a(a){c.on("keyup",f),a.on("focus",function(){d.handleFocus(a)}),a.on("blur",function(){d.handleBlur(a)})}for(var c,d=this,e=0,f=b.proxy(this.updateValue,this);c=this.$values[e++];)a(c)},e.prototype.handleBlur=function(a){var b=a.val();(""===b||f.test(b))&&a.val(0)},e.prototype.handleFocus=function(a){f.test(a.val())&&a.val("")},e.prototype.updateValue=function(){for(var a,b,d=0,e=0,f=0;a=this.$values[e++];)b=parseInt(a.val(),10),b>0&&(d+=b,f++);this.$totalYears.text(f+(1===f?" year":" years")),this.$totalValue.text(this.currency+c(d)),this.$total.val(d)},e}(document,jQuery,ew.tools.toLocaleString),ew.components.ToggleContributors=function(a){function b(a){return a+" is required for ToggleContributorsComponent"}function c(a){if(!a)throw new Error(b("opts"));if(!a.$contributingTeamDetails)throw new Error(b("opts.$contributingTeamDetails"));if(!a.$someContributors)throw new Error(b("opts.$someContributors"));if(!a.noContributorsSelector)throw new Error(b("opts.noContributorsSelector"));this.$contributingTeamDetails=a.$contributingTeamDetails,this.$someContributors=a.$someContributors,this.noContributorsSelector=a.noContributorsSelector,this.events={showDetails:new ew.CustomEvent},this.checkContributingDetails(),this.createListeners()}return c.prototype.toggleContributingDetails=function(a){this.$someContributors[0].checked?(this.$contributingTeamDetails.show(),this.events.showDetails.publish()):this.$contributingTeamDetails.hide()},c.prototype.createListeners=function(){var b=a(this.noContributorsSelector),c=a.proxy(this.toggleContributingDetails,this);this.$someContributors.on("click",c),b.on("click",c)},c.prototype.checkContributingDetails=function(){this.$someContributors[0].checked||this.$contributingTeamDetails.hide()},c}(jQuery),ew.components.ToggleExportValue=function(a){function b(a){return a+" is required for ToggleExportValueComponent"}function c(c){if(!c)throw new Error(b("opts"));if(!c.fieldName)throw new Error(b("opts.fieldName"));if(!c.exportValue)throw new Error(b("opts.exportValue"));if(!c.nonExportValue)throw new Error(b("opts.nonExportValue"));if(!c.bothValue)throw new Error(b("opts.bothValue"));if(!c.exportId)throw new Error(b("opts.exportId"));if(!c.nonExportId)throw new Error(b("opts.nonExportId"));this.fieldName=c.fieldName,this.exportValue=c.exportValue,this.nonExportValue=c.nonExportValue,this.bothValue=c.bothValue,this.$exportContent=a("#"+c.exportId),this.$nonExportContent=a("#"+c.nonExportId),this.$field=a("input[ name="+this.fieldName+"]"),this.$field.on("change",a.proxy(this.showContent,this)),this.showContent()}return c.prototype.showContent=function(){var b=a("input[ name="+this.fieldName+"]:checked").val();switch(b){case this.exportValue:this.$exportContent.show(),this.$nonExportContent.hide();break;case this.nonExportValue:this.$exportContent.hide(),this.$nonExportContent.show();break;case this.bothValue:this.$exportContent.show(),this.$nonExportContent.show();break;default:this.$exportContent.hide(),this.$nonExportContent.hide()}},c}(jQuery),ew.components.WordCounter=function(a){function b(a){return a+"is required for WordCounterComponent"}function c(c){if(!c)throw new Error(b("opts"));if(!c.limit)throw new Error(b("opts.limit"));if(!c.id)throw new Error(b("opts.id"));this.limit=c.limit,this.$input=a("#"+c.id),this.createCounter(),this.$input.on("keyup",a.proxy(this.upateCount,this))}var d="text-danger";return c.prototype.createCounter=function(){this.$counter=a('<span class="word-counter">0 words</span>'),this.$counter.insertAfter(this.$input),this.upateCount()},c.prototype.getWordCount=function(a){return a.replace(/\s+$/,"").split(" ").length},c.prototype.upateCount=function(){var a=this.$input.val(),b=a?this.getWordCount(a):0,c=1===b?"word":"words";this.$counter.text(b+" "+c),b>this.limit?this.$counter.addClass(d):this.$counter.removeClass(d)},c}(jQuery),ew.pages.confirmationForm=function(a){var b=$("#confirm-false-info"),c=$("form input[name="+a+"]");$("#confirm-false-details");c[1].checked||b.hide(),c.on("change",function(a){c[0].checked?b.hide():b.show()})},ew.pages.officerForm=function(){function a(){var a="#id_hq_team",b=a+" option";$("#id_team_type").on("change",function(){var c,d=$(this).val();d?(c=$("#id_hq_team option[value^="+d+"]"),$(b).addClass(f),c.removeClass(f),$(a).val(c.first().val())):($(b).removeClass(f),$(a)[0].selectedIndex=0)})}function b(){$(".contributing-officer-team-group .contributing-team-type select").on("change",function(){var a,b=$(this),c=b.val(),d=b.closest(".row").find(".contributing-team select");c?(a=d.find("option[value^="+c+"]"),d.val(a.first().val()),d.find("option").addClass(f),a.removeClass(f)):(d.find("option").removeClass(f),d[0].selectedIndex=0)})}function c(a,b){b.descriptionWordCounter=new ew.components.WordCounter({id:a.descriptionId,limit:50}),b.exportValues=new ew.components.ToggleExportValue({fieldName:a.exportType.name,exportValue:a.exportType.exportValue,nonExportValue:a.exportType.nonExportValue,bothValue:a.exportType.bothValue,exportId:a.exportContentId,nonExportId:a.nonExportContentId}),b.calculateExportValue=new ew.components.CalculateExportValue({values:a.exportValues,total:a.exportTotal}),b.calculateNonExportValue=new ew.components.CalculateExportValue({values:a.nonExportValues,total:a.nonExportTotal})}function d(a,b){b.toggleContributors=new ew.components.ToggleContributors({$contributingTeamDetails:$("#contributing-teams-details"),$someContributors:$("#some-contributors"),noContributorsSelector:"#no-contributors"}),b.addContributors=new ew.components.AddContributors({contributorsSelector:".contributing-officer-group",nameInputSelector:".contributing-officer-name input"}),b.toggleContributors.events.showDetails.subscribe(function(){b.addContributors.focusOnFirstNameInput(),b.addContributors.updateCloseButton()}),b.supportSelects=new ew.components.AddSelect(a.supportGroup),b.programmeSelects=new ew.components.AddSelect(a.programmeGroup)}function e(a){return a+" is required for officerFormPage"}var f="hidden";return function(f){if(!f)throw new Error(e("opts"));if("undefined"==typeof f.isComplete)throw new Error(e("opts.isComplete"));if(!f.supportGroup)throw new Error(e("opts.supportGroup"));if(!f.programmeGroup)throw new Error(e("opts.programmeGroup"));if(!f.isComplete){if(!f.descriptionId)throw new Error(e("opts.descriptionId"));if(!f.exportType)throw new Error(e("opts.exportType"));if(!f.exportType.name)throw new Error(e("opts.exportType.name"));if(!f.exportType.exportValue)throw new Error(e("opts.exportType.exportValue"));if(!f.exportType.nonExportValue)throw new Error(e("opts.exportType.nonExportValue"));if(!f.exportType.bothValue)throw new Error(e("opts.exportType.bothValue"));if(!f.exportContentId)throw new Error(e("opts.exportContentId"));if(!f.nonExportContentId)throw new Error(e("opts.nonExportContentId"));if(!f.exportValues||!f.exportValues.length)throw new Error(e("opts.exportValue"));if(!f.exportTotal)throw new Error(e("opts.exportTotal"));if(!f.nonExportValues||!f.nonExportValues.length)throw new Error(e("opts.nonExportValues"));if(!f.nonExportTotal)throw new Error(e("opts.nonExportTotal"))}var g=ew.application,h=g.components;a(),b(),d(f,h),f.isComplete||c(f,h)}}();
//# sourceMappingURL=main.min.js.map